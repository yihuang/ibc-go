"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[75714],{51888:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>c});var t=s(85893),i=s(11151);const r={title:"Messages",sidebar_label:"Messages",sidebar_position:4,slug:"/apps/transfer/messages"},o="Messages",a={id:"apps/transfer/messages",title:"Messages",description:"MsgTransfer",source:"@site/docs/02-apps/01-transfer/04-messages.md",sourceDirName:"02-apps/01-transfer",slug:"/apps/transfer/messages",permalink:"/main/apps/transfer/messages",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Messages",sidebar_label:"Messages",sidebar_position:4,slug:"/apps/transfer/messages"},sidebar:"defaultSidebar",previous:{title:"State Transitions",permalink:"/main/apps/transfer/state-transitions"},next:{title:"Events",permalink:"/main/apps/transfer/events"}},d={},c=[{value:"<code>MsgTransfer</code>",id:"msgtransfer",level:2},{value:"Memo",id:"memo",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"messages",children:"Messages"}),"\n",(0,t.jsx)(n.h2,{id:"msgtransfer",children:(0,t.jsx)(n.code,{children:"MsgTransfer"})}),"\n",(0,t.jsxs)(n.p,{children:["A fungible token cross chain transfer is achieved by using the ",(0,t.jsx)(n.code,{children:"MsgTransfer"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-go",children:"type MsgTransfer struct {\n  SourcePort        string\n  SourceChannel     string\n  // Deprecated: Use Tokens instead.\n  Token             sdk.Coin\n  Sender            string\n  Receiver          string\n  TimeoutHeight     ibcexported.Height\n  TimeoutTimestamp  uint64\n  Memo              string\n  Tokens            []sdk.Coin\n  Forwarding        *Forwarding\n}\n\ntype Forwarding struct {\n\tUnwind bool\n\tHops  []Hop\n}\n\ntype Hop struct {\n\tPortId    string\n\tChannelId string\n}\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"Multi-denom token transfers and token forwarding are features supported only on ICS20 v2 transfer channels."})}),"\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"Forwarding"})," is ",(0,t.jsx)(n.code,{children:"nil"}),", this message is expected to fail if:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"SourcePort"})," is invalid (see ",(0,t.jsx)(n.a,{href:"https://github.com/cosmos/ibc/blob/master/spec/core/ics-024-host-requirements/README.md#paths-identifiers-separators",children:"24-host naming requirements"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"SourceChannel"})," is invalid (see ",(0,t.jsx)(n.a,{href:"https://github.com/cosmos/ibc/blob/master/spec/core/ics-024-host-requirements/README.md#paths-identifiers-separators",children:"24-host naming requirements"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Tokens"})," must not be empty."]}),"\n",(0,t.jsxs)(n.li,{children:["Each ",(0,t.jsx)(n.code,{children:"Coin"})," in ",(0,t.jsx)(n.code,{children:"Tokens"})," must satisfy the following:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Amount"})," must be positive."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Denom"})," must be a valid IBC denomination, as defined in ",(0,t.jsx)(n.a,{href:"/architecture/adr-001-coin-source-tracing",children:"ADR 001 - Coin Source Tracing"}),"."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Sender"})," is empty."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Receiver"})," is empty or contains more than 2048 bytes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Memo"})," contains more than 32768 bytes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"TimeoutHeight"})," and ",(0,t.jsx)(n.code,{children:"TimeoutTimestamp"})," are both zero."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If ",(0,t.jsx)(n.code,{children:"Forwarding"})," is not ",(0,t.jsx)(n.code,{children:"nil"}),", then to use forwarding you must either set ",(0,t.jsx)(n.code,{children:"Unwind"})," to true or provide a non-empty list of ",(0,t.jsx)(n.code,{children:"Hops"}),". Setting both ",(0,t.jsx)(n.code,{children:"Unwind"})," to true and providing a non-empty list of ",(0,t.jsx)(n.code,{children:"Hops"})," is allowed, but the total number of hops that is formed as a combination of the hops needed to unwind the tokens and the hops to forward them afterwards to the final destination must not exceed 8. When using forwarding, timeout must be specified using only ",(0,t.jsx)(n.code,{children:"TimeoutTimestamp"})," (i.e. ",(0,t.jsx)(n.code,{children:"TimeoutHeight"})," must be zero). Please note that the timeout timestamp must take into account the time that it may take tokens to be forwarded through the intermediary chains. Additionally, please note that the ",(0,t.jsx)(n.code,{children:"MsgTransfer"})," will fail if:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Hops"})," is not empty, and the number of elements of ",(0,t.jsx)(n.code,{children:"Hops"})," is greater than 8, or either the ",(0,t.jsx)(n.code,{children:"PortId"})," or ",(0,t.jsx)(n.code,{children:"ChannelId"})," of any of the ",(0,t.jsx)(n.code,{children:"Hops"})," is not a valid identifier."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"Unwind"})," is true, and either the coins to be transferred have different denomination traces, or ",(0,t.jsx)(n.code,{children:"SourcePort"})," and ",(0,t.jsx)(n.code,{children:"SourceChannel"})," are not empty strings (they must be empty because they are set by the transfer module, since it has access to the denomination trace information and is thus able to know the source port ID, channel ID to use in order to unwind the tokens). If ",(0,t.jsx)(n.code,{children:"Unwind"})," is true, the transfer module expects the tokens in ",(0,t.jsx)(n.code,{children:"MsgTransfer"})," to not be native to the sending chain (i.e. they must be IBC vouchers)."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Please note that the ",(0,t.jsx)(n.code,{children:"Token"})," field is deprecated and users should now use ",(0,t.jsx)(n.code,{children:"Tokens"})," instead. If ",(0,t.jsx)(n.code,{children:"Token"})," is used then ",(0,t.jsx)(n.code,{children:"Tokens"})," must be empty. Similarly, if ",(0,t.jsx)(n.code,{children:"Tokens"})," is used then ",(0,t.jsx)(n.code,{children:"Token"})," should be left empty. This message will send a fungible token to the counterparty chain represented by the counterparty Channel End connected to the Channel End with the identifiers ",(0,t.jsx)(n.code,{children:"SourcePort"})," and ",(0,t.jsx)(n.code,{children:"SourceChannel"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"The denomination provided for transfer should correspond to the same denomination represented on this chain. The prefixes will be added as necessary upon by the receiving chain."}),"\n",(0,t.jsxs)(n.p,{children:["If the ",(0,t.jsx)(n.code,{children:"Amount"})," is set to the maximum value for a 256-bit unsigned integer (i.e. 2^256 - 1), then the whole balance of the corresponding denomination will be transferred. The helper function ",(0,t.jsx)(n.code,{children:"UnboundedSpendLimit"})," in the ",(0,t.jsx)(n.code,{children:"types"})," package of the ",(0,t.jsx)(n.code,{children:"transfer"})," module provides the sentinel value that can be used."]}),"\n",(0,t.jsx)(n.h3,{id:"memo",children:"Memo"}),"\n",(0,t.jsx)(n.p,{children:"The memo field was added to allow applications and users to attach metadata to transfer packets. The field is optional and may be left empty. When it is used to attach metadata for a particular middleware, the memo field should be represented as a json object where different middlewares use different json keys."}),"\n",(0,t.jsxs)(n.p,{children:["For example, the following memo field is used by the ",(0,t.jsx)(n.a,{href:"/main/middleware/callbacks/overview",children:"callbacks middleware"})," to attach a source callback to a transfer packet:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-jsonc",children:'{\n  "src_callback": {\n    "address": "callbackAddressString",\n    // optional\n    "gas_limit": "userDefinedGasLimitString",\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["You can find more information about other applications that use the memo field in the ",(0,t.jsx)(n.a,{href:"https://github.com/cosmos/chain-registry/blob/master/_memo_keys/ICS20_memo_keys.json",children:"chain registry"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Please note that the memo field is always meant to be consumed only on the final destination chain. This means that the transfer module will guarantee that the memo field in the intermediary chains is empty."})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},11151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>o});var t=s(67294);const i={},r=t.createContext(i);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);